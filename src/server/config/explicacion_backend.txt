ğŸ“Œ Puntos clave de tu backend:
ğŸ”‘ AutenticaciÃ³n con JWT:
Se genera un token JWT despuÃ©s de hacer login y se almacena en una cookie httpOnly.
La cookie se envÃ­a con httpOnly: true, lo que impide el acceso directo desde el frontend con localStorage.
ğŸ” Middleware de autenticaciÃ³n (authMiddleware):
Verifica el token en las cookies (req.cookies.token).
Si el token es vÃ¡lido, aÃ±ade los datos del usuario a req.user y deja pasar la peticiÃ³n.
Si no hay token o es invÃ¡lido, devuelve un 401 Unauthorized.
ğŸšª Logout (logout):
Elimina la cookie del usuario con res.clearCookie("token", { path: "/" }).
ğŸ›¢ï¸ Base de datos SQL Server:
Se usa MSSQL para almacenar usuarios y relaciones.
ContraseÃ±as encriptadas con bcrypt para mayor seguridad.
ğŸ” Diferencias entre authController.js y userController.js
Ambos controladores manejan informaciÃ³n de los usuarios, pero con diferentes propÃ³sitos:

ğŸ› ï¸ authController.js (AutenticaciÃ³n y sesiÃ³n)
Maneja autenticaciÃ³n: login, logout y perfil del usuario autenticado.
No devuelve datos de otros usuarios, solo del usuario en sesiÃ³n.
GET /api/auth/me usa getUserProfile() para obtener los datos del usuario autenticado mediante su token.
ğŸ“Œ Endpoints de authController.js
AcciÃ³n	Endpoint	MÃ©todo
Login	/api/auth/login	POST
Logout	/api/auth/logout	POST
Obtener perfil del usuario autenticado	/api/auth/me	GET
Registro de usuario	/api/auth/register	POST
js
Copiar
Editar
const getUserProfile = async (req, res) => {
    const query = `
        SELECT user_id, user_handle, email_address, first_name, last_name, 
               avatar_url, cover_url, last_login, user_role
        FROM users WHERE user_id = @user_id`;

    const result = await executeQuery(query, [
        { name: "user_id", type: db.Int, value: req.user.id },
    ]);

    res.json({
        user_id: user.user_id,
        user_handle: user.user_handle,
        email: user.email_address,
        name: `${user.first_name} ${user.last_name}`,
        avatarUrl: user.avatar_url || null,
        coverUrl: user.cover_url || null, // ğŸ”¥ Ahora incluye cover_url
        lastLogin: user.last_login,
        isOnline: true,
        role: user.user_role,
    });
};
ğŸ” userController.js (InformaciÃ³n general de usuarios)
Obtiene informaciÃ³n de otros usuarios, no solo del autenticado.
Incluye datos como seguidores, seguidos, detalles adicionales, etc.
GET /api/user/:id usa getUserData() para obtener la info de cualquier usuario dado su user_id.
ğŸ“Œ Endpoints de userController.js
AcciÃ³n	Endpoint	MÃ©todo
Obtener datos de cualquier usuario	/api/user/:id	GET
Obtener detalles adicionales del usuario	/api/user/:id/details	GET
js
Copiar
Editar
const getUserData = async (req, res) => {
    const userId = req.params.id; // ğŸ”¥ Se obtiene el ID del usuario desde la URL

    const query = `
        SELECT 
            u.first_name, 
            u.last_name, 
            u.user_handle, 
            u.avatar_url, 
            u.cover_url, 
            u.location, 
            u.date_of_birth, 
            u.email_address, 
            u.bio, 
            (SELECT COUNT(*) FROM followers WHERE following_id = @userId) AS followers,
            (SELECT COUNT(*) FROM followers WHERE follower_id = @userId) AS following
        FROM users u
        WHERE u.user_id = @userId
    `;

    const inputs = [{ name: "userId", type: db.Int, value: userId }];
    const result = await executeQuery(query, inputs);

    res.send(result.recordset[0]);
};
ğŸ“Œ Â¿CuÃ¡ndo usar cada uno?
Caso	authController.js	userController.js
Obtener datos del usuario autenticado	âœ… GET /api/auth/me	âŒ No aplica
Obtener datos de otro usuario por user_id	âŒ No aplica	âœ… GET /api/user/:id
Iniciar sesiÃ³n	âœ… POST /api/auth/login	âŒ No aplica
Cerrar sesiÃ³n	âœ… POST /api/auth/logout	âŒ No aplica
Obtener seguidores, seguidos, etc.	âŒ No aplica	âœ… GET /api/user/:id
ğŸ”§ ConclusiÃ³n
authController.js â†’ Para autenticaciÃ³n y datos del usuario logueado.
userController.js â†’ Para obtener datos de cualquier usuario.
El error de la portada (cover_url) se solucionÃ³ al agregarlo a getUserProfile() en authController.js. ğŸš€